# Default values for cycloid.
# This is a YAML-formatted file.
# Declare variables to be passed into your templates.

nameOverride: ""
fullnameOverride: ""
# Labels to add to all deployed objects
commonLabels: {}
# Annotations to add to all deployed objects
commonAnnotations: {}

# Image pull secret to use for registry authentication.
# The default value matches the secret created during the documentation installation steps
# which provide access to the AWS ECR Cycloid docker images.
imagePullSecrets:
  - name: cycloid-ecr

#
# Cycloid Console frontend
#
frontend:
  # True if you want to enable the Cycloid Console frontend.
  enabled: true

  nameOverride: "frontend"
  fullnameOverride: ""

  # The externally accessible FQDN for the Cycloid Console frontend.
  # If you change this value, don't to also update the ingress declaration below.
  url: "http://console.cycloid.local"

  replicaCount: 1

  image:
    repository: 661913936052.dkr.ecr.eu-west-1.amazonaws.com/youdeploy-frontend
    pullPolicy: IfNotPresent
    # Cycloid Console frontend version to use.
    # Overrides the image tag whose default is the chart appVersion.
    tag: "v3.0.4"

  # extraEnvVars is a list of extra environment variables to set.
  extraEnvVars: {}
    # MYENVVAR: VALUE

  # extraSecretEnvVars is a list of extra environment variables to set.
  # These variables take value from existing Secret objects.
  extraSecretEnvVars: []
    # - envName: MYENVVAR
    #   secretName: secret_name
    #   secretKey: SECRET_KEY

  # extraConfigMapEnvVars is a list of extra environment variables to set.
  # These variables take value from existing ConfigMap objects.
  extraConfigMapEnvVars: []
    # - envName: MYENVVAR
    #   configMapName: configmap_name
    #   configMapKey: CONFIGMAP_KEY

  # extraFullConfigMapEnvVars is the name of an existing ConfigMap containing extra env vars for containers.
  # All the ConfigMap keys will be accessible as env vars within the containers.
  extraFullConfigMapEnvVars: ""

  # extraFullSecretEnvVars is the name of an existing Secret containing extra env vars for containers.
  # All the Secret keys will be accessible as env vars within the containers.
  extraFullSecretEnvVars: ""

  serviceAccount:
    # Specifies whether a service account should be created
    create: true
    # Annotations to add to the service account
    annotations: {}
    # The name of the service account to use.
    # If not set and create is true, a name is generated using the fullname template
    name: ""

  podAnnotations: {}

  podSecurityContext: {}
    # fsGroup: 2000

  securityContext: {}
    # capabilities:
    #   drop:
    #   - ALL
    # readOnlyRootFilesystem: true
    # runAsNonRoot: true
    # runAsUser: 1000

  service:
    type: ClusterIP
    port: 80

  ingress:
    enabled: true
    className: ""
    annotations: {}
      # kubernetes.io/ingress.class: nginx
      # kubernetes.io/tls-acme: "true"
    hosts:
      - host: console.cycloid.local
        paths:
          - path: /
            pathType: ImplementationSpecific
    tls: []
    #  - secretName: cycloid-local-tls
    #    hosts:
    #      - console.cycloid.local

  resources: {}
    # We usually recommend not to specify default resources and to leave this as a conscious
    # choice for the user. This also increases chances charts run on environments with little
    # resources, such as Minikube. If you do want to specify resources, uncomment the following
    # lines, adjust them as necessary, and remove the curly braces after 'resources:'.
    # limits:
    #   cpu: 100m
    #   memory: 128Mi
    # requests:
    #   cpu: 100m
    #   memory: 128Mi

  autoscaling:
    enabled: false
    minReplicas: 1
    maxReplicas: 100
    targetCPUUtilizationPercentage: 80
    # targetMemoryUtilizationPercentage: 80

  # Affinity Settings
  # Commenting out or setting as empty the affinity variable, will allow
  # deployment to single node services such as Minikube
  # This should be either a multi-line string or YAML matching the PodSpec's affinity field.
  affinity: |
    podAntiAffinity:
      preferredDuringSchedulingIgnoredDuringExecution:
        - podAffinityTerm:
            labelSelector:
              matchLabels:
                app.kubernetes.io/name: {{ template "frontend.name" . }}
                app.kubernetes.io/instance: "{{ .Release.Name }}"
            namespaces:
              - {{ .Release.Namespace | quote }}
            topologyKey: kubernetes.io/hostname
          weight: 1
  # affinity: |
  #   podAntiAffinity:
  #     requiredDuringSchedulingIgnoredDuringExecution:
  #       - labelSelector:
  #           matchLabels:
  #             app.kubernetes.io/name: {{ template "frontend.name" . }}
  #             app.kubernetes.io/instance: "{{ .Release.Name }}"
  #         topologyKey: kubernetes.io/hostname

  # Toleration Settings for server pods
  # This should be either a multi-line string or YAML matching the Toleration array
  # in a PodSpec.
  tolerations: []

  # nodeSelector labels for server pod assignment, formatted as a multi-line string or YAML map.
  # ref: https://kubernetes.io/docs/concepts/configuration/assign-pod-node/#nodeselector
  # Example:
  # nodeSelector:
  #   beta.kubernetes.io/arch: amd64
  nodeSelector: {}

#
# Cycloid Console API
#
backend:
  # True if you want to enable the Cycloid Console API.
  enabled: true

  nameOverride: "backend"
  fullnameOverride: ""

  # The externally accessible FQDN for the Cycloid Console API.
  # If you change this value, don't to also update the ingress declaration below.
  url: "http://api.cycloid.local"

  replicaCount: 1

  image:
    repository: 661913936052.dkr.ecr.eu-west-1.amazonaws.com/youdeploy-http-api
    pullPolicy: IfNotPresent
    # Cycloid Console API version to use.
    # Overrides the image tag whose default is the chart appVersion.
    tag: "v1.0.92"

  # Concourse server to be used by the Cycloid Console API.
  # Defaults to the included one within the chart, but you also use a custom one if needed.
  concourse:
    url: "http://cycloid-concourse-web"
    port: 8080
    team: main
    user: cycloid
    # We recommend changing this default value, but don't forget to update the matching password
    # in the concourse section below.
    password: "jeiVahChaipheigai8ohkuc0"

  # Vault server to be used by the Cycloid Console API.
  # Defaults to the included one within the chart, but you also use a custom one if needed.
  vault:
    url: "http://cycloid-vault:8200"
    # These value have to be changed as explained in the installation documentation.
    roleId: "##cycloid-vault-approle-role-id##"
    secretId: "##cycloid-vault-approle-secret-id##"

  cryptoSigningKey: totally-random-secret-key
  jwtKey1: "2f2122de-63f2-4eec-9c6f-c6abb3e1f007:7cdyHps2tYDp6e7VKPEstE5sDMQbK6WLyN3GmTsF7x7QpE6ZP5ra6yfVSkvXakbB"

  # extraEnvVars is a list of extra environment variables to set.
  extraEnvVars:
    EMAIL_SMTP_SVR_ADDR: "##smtp-host:smtp-port##"
    EMAIL_SMTP_USERNAME: "##smtp-username##"
    EMAIL_SMTP_PASSWORD: "##smtp-password##"
    EMAIL_ADDR_FROM: "Cycloid Console <noreply@domain.tld>"
    EMAIL_ADDR_RETURN_PATH: "admin@domain.tld"
    EMAIL_INSECURE: false
    LOG_DEV_MODE: false
    LOG_LEVEL: "INFO"
    LOG_SVC_LEVEL: "NONE"
    # COST_EXPLORER_ES_INSECURE_SKIP_TLS: true
    # AZURE_TENANT_ID: "SECRET"
    # AZURE_CLIENT_ID: "SECRET"
    # GOOGLE_CLIENT_ID: "SECRET"
    # GITHUB_CLIENT_ID: "SECRET"
    # GITHUB_CLIENT_SECRET: "SECRET"
    # SAML_SP_CERTIFICATE_PATH: "/secrets/saml/sp_cert"
    # SAML_SP_PRIVATE_KEY_PATH: "/secrets/saml/sp_private_key"
    # SAML_IDP_METADATA_PATH: "/secrets/saml/idp_metadata"

    # Allow additional Origins to request the API. Multiple Origins can be specified using a comma ','.
    # e.g, CORS_ALLOWED_ORIGINS: "https://domain1.tld,http://domain2.tld"
    # By default, the Frontend URL is already allowed.
    # CORS_ALLOWED_ORIGINS: ""

  # extraSecretEnvVars is a list of extra environment variables to set.
  # These variables take value from existing Secret objects.
  extraSecretEnvVars: []
    # - envName: COST_EXPLORER_ES_CA_CERT
    #   secretName: cost-explorer-es-http-certs-public
    #   secretKey: ca.crt
    # - envName: SAML_IDP_METADATA_URL
    #   secretName: saml
    #   secretKey: SAML_IDP_METADATA_URL

  # extraConfigMapEnvVars is a list of extra environment variables to set.
  # These variables take value from existing ConfigMap objects.
  extraConfigMapEnvVars: []
    # - envName: AWS_SECRET_ACCESS_KEY
    #   configMapName: vault
    #   configMapKey: AWS_SECRET_ACCESS_KEY

  # extraFullConfigMapEnvVars is the name of an existing ConfigMap containing extra env vars for containers.
  # All the ConfigMap keys will be accessible as env vars within the containers.
  extraFullConfigMapEnvVars: ""

  # extraFullSecretEnvVars is the name of an existing Secret containing extra env vars for containers.
  # All the Secret keys will be accessible as env vars within the containers.
  extraFullSecretEnvVars: ""

  # volumes is a list of volumes made available to all containers. These are rendered
  # via toYaml rather than pre-processed like the extraVolumes value.
  # The purpose is to make it easy to share volumes between containers.
  volumes: []
    # - name: saml
    #   secret:
    #     secretName: saml
    #     items:
    #       - key: "SAML_SP_CERTIFICATE"
    #         path: "sp_cert"
    #       - key: "SAML_SP_PRIVATE_KEY"
    #         path: "sp_private_key"
    #       - key: "SAML_IDP_METADATA"
    #         path: "idp_metadata"

  # volumeMounts is a list of volumeMounts for the main server container. These are rendered
  # via toYaml rather than pre-processed like the extraVolumes value.
  # The purpose is to make it easy to share volumes between containers.
  volumeMounts: []
    # - name: saml
    #   mountPath: "/secrets/saml"
    #   readOnly: true

  serviceAccount:
    # Specifies whether a service account should be created
    create: true
    # Annotations to add to the service account
    annotations: {}
    # The name of the service account to use.
    # If not set and create is true, a name is generated using the fullname template
    name: ""

  podAnnotations: {}

  podSecurityContext: {}
    # fsGroup: 2000

  securityContext: {}
    # capabilities:
    #   drop:
    #   - ALL
    # readOnlyRootFilesystem: true
    # runAsNonRoot: true
    # runAsUser: 1000

  service:
    type: ClusterIP
    port: 80

  ingress:
    enabled: true
    className: ""
    annotations:
      # kubernetes.io/ingress.class: nginx
      # kubernetes.io/tls-acme: "true"
      nginx.ingress.kubernetes.io/proxy-connect-timeout: "360"
      nginx.ingress.kubernetes.io/proxy-send-timeout: "360"
      nginx.ingress.kubernetes.io/proxy-read-timeout: "360"
      nginx.ingress.kubernetes.io/configuration-snippet: "chunked_transfer_encoding off;"
      # If using the nginx-ingress-controller from NGINXinc: https://github.com/nginxinc/kubernetes-ingress
      # nginx.org/proxy-connect-timeout: "360s"
      # nginx.org/proxy-send-timeout: "360s"
      # nginx.org/proxy-read-timeout: "360s"
      # nginx.org/location-snippets: "chunked_transfer_encoding off;"
    hosts:
      - host: api.cycloid.local
        paths:
          - path: /
            pathType: ImplementationSpecific
    tls: []
    #  - secretName: cycloid-local-tls
    #    hosts:
    #      - api.cycloid.local

  resources: {}
    # We usually recommend not to specify default resources and to leave this as a conscious
    # choice for the user. This also increases chances charts run on environments with little
    # resources, such as Minikube. If you do want to specify resources, uncomment the following
    # lines, adjust them as necessary, and remove the curly braces after 'resources:'.
    # limits:
    #   cpu: 500m
    #   memory: 256Mi
    # requests:
    #   cpu: 1
    #   memory: 512Mi

  autoscaling:
    enabled: false
    minReplicas: 1
    maxReplicas: 100
    targetCPUUtilizationPercentage: 80
    # targetMemoryUtilizationPercentage: 80

  # Affinity Settings
  # Commenting out or setting as empty the affinity variable, will allow
  # deployment to single node services such as Minikube
  # This should be either a multi-line string or YAML matching the PodSpec's affinity field.
  affinity: |
    podAntiAffinity:
      preferredDuringSchedulingIgnoredDuringExecution:
        - podAffinityTerm:
            labelSelector:
              matchLabels:
                app.kubernetes.io/name: {{ template "backend.name" . }}
                app.kubernetes.io/instance: "{{ .Release.Name }}"
            namespaces:
              - {{ .Release.Namespace | quote }}
            topologyKey: kubernetes.io/hostname
          weight: 1
  # affinity: |
  #   podAntiAffinity:
  #     requiredDuringSchedulingIgnoredDuringExecution:
  #       - labelSelector:
  #           matchLabels:
  #             app.kubernetes.io/name: {{ template "backend.name" . }}
  #             app.kubernetes.io/instance: "{{ .Release.Name }}"
  #         topologyKey: kubernetes.io/hostname

  # Toleration Settings for server pods
  # This should be either a multi-line string or YAML matching the Toleration array
  # in a PodSpec.
  tolerations: []

  # nodeSelector labels for server pod assignment, formatted as a multi-line string or YAML map.
  # ref: https://kubernetes.io/docs/concepts/configuration/assign-pod-node/#nodeselector
  # Example:
  # nodeSelector:
  #   beta.kubernetes.io/arch: amd64
  nodeSelector: {}

  cronJob:
    resources: {}
      # We usually recommend not to specify cronjob resources and to leave this as a conscious
      # choice for the user. This also increases chances charts run on environments with little
      # resources, such as Minikube. If you do want to specify resources, uncomment the following
      # lines, adjust them as necessary, and remove the curly braces after 'resources:'.
      # limits:
      #   cpu: 500m
      #   memory: 256Mi
      # requests:
      #   cpu: 1
      #   memory: 512Mi

#
# MySQL
#
# Configuration values for the mysql dependency.
# Ref: https://github.com/bitnami/charts/tree/master/bitnami/mysql
#
mysql:
  ## Use the MySQL chart dependency.
  ##
  ## Set to false if bringing your own MySQL, and set the corresponding `secrets`
  ## fields that correspond to the PostgreSQL variables that `concourse web` should use
  ## to connect to.
  ##
  enabled: true

  nameOverride: "mysql"

  image:
    registry: docker.io
    repository: bitnami/mysql
    tag: 8.0.21-debian-10-r80

  ## MySQL Authentication parameters
  ## @param mysql.auth.rootPassword MySQL root password
  ## @param mysql.auth.database MySQL custom database
  ## @param mysql.auth.username MySQL custom user name
  ## @param mysql.auth.password MySQL custom user password
  ## ref: https://github.com/bitnami/bitnami-docker-mysql#setting-the-root-password-on-first-run
  ##      https://github.com/bitnami/bitnami-docker-mysql/blob/master/README.md#creating-a-database-on-first-run
  ##      https://github.com/bitnami/bitnami-docker-mysql/blob/master/README.md#creating-a-database-user-on-first-run
  auth:
    rootPassword: "Ti3eitheeyoo9AhieQu5chae"
    database: cycloid
    username: cycloid
    password: "xeemohCahh1AezahcapheeP7"

  ## @param architecture MySQL architecture (`standalone` or `replication`)
  ##
  architecture: standalone

  ## MySQL Primary configuration
  ##
  primary:
    # MySQL Primary Persistence parameters
    # ref: http://kubernetes.io/docs/user-guide/persistent-volumes/
    # @param mysql.primary.persistence.enabled Enable persistence on MySQL using PVC(s)
    # @param mysql.primary.persistence.storageClass Persistent Volume storage class
    # @param mysql.primary.persistence.accessModes [array] Persistent Volume access modes
    # @param mysql.primary.persistence.size Persistent Volume size
    #
    persistence:
      enabled: true
      storageClass: ""
      accessModes:
        - ReadWriteOnce
      size: 8Gi

#
# External MySQL Configuration
# All of these values are only used if `mysql.enabled=false`
#
externalMysql:
  # External MySQL server host
  host: localhost
  # External MySQL server port
  port: 3306
  # External MySQL username
  user: cycloid
  # External MySQL user password
  password: ""
  #External MySQL database name
  database: cycloid
  #The name of an existing secret with database credentials
  # NOTE: Must contain key `mysql-password`
  # NOTE: When it's set, the `externalMysql.password` parameter is ignored
  existingSecret: ""

#
# Redis
#
# Configuration values for the redis dependency.
# Ref: https://github.com/bitnami/charts/tree/master/bitnami/redis
#
redis:
  ## Use the Redis chart dependency.
  ##
  ## Set to false if bringing your own MySQL, and set the corresponding `secrets`
  ## fields that correspond to the PostgreSQL variables that `concourse web` should use
  ## to connect to.
  ##
  enabled: true

  nameOverride: "redis"

  image:
    registry: docker.io
    repository: bitnami/redis
    tag: 6.0.9-debian-10-r72

  ## Redis Authentication parameters
  ## ref: https://github.com/bitnami/bitnami-docker-redis#setting-the-server-password-on-first-run
  ##
  auth:
    ## @param auth.enabled Enable password authentication
    ##
    enabled: true
    ## @param auth.password Redis password
    ## Defaults to a random 10-character alphanumeric string if not set
    ##
    password: "ociaseij9so2ooThiut0dug7"

  ## @param architecture Redis&trade; architecture. Allowed values: `standalone` or `replication`
  ##
  architecture: standalone

  cluster:
    enabled: false

  persistence:
    enabled: true
    storageClass: ""
    accessModes:
      - ReadWriteOnce
    size: 8Gi

#
# External Redis Configuration
# All of these values are only used if `redis.enabled=false`
#
externalRedis:
  #External Redis server host
  host: localhost
  #External Redis server port
  port: 6379
  #External Redis server database
  database: 0
  #External Redis password
  password: ""

#
# External Elasticsearch Configuration
#
externalElasticsearch:
  # for now, the externalElasticsearch config will be at first
  # the only solution to configure the backend for Cloud Cost Management
  enabled: false
  #External ES server protocol
  scheme: https
  #External ES server host
  host: cost-explorer-es-http
  #External ES server port
  port: 9200
  #External ES server database
  username: elastic
  #External ES password
  password: ""
  #The name of an existing secret with database credentials
  # NOTE: Must contain key `elasticsearch-password` by default is not overriden with `existingSecretKey`
  # NOTE: When it's set, the `externalElasticsearch.password` parameter is ignored
  existingSecret: ""
  #existingSecretKey: elastic

#
# Concourse
#
# Configuration values for the concourse dependency.
# Ref: https://github.com/concourse/concourse-chart
#
concourse:
  ## Use the Concourse chart dependency.
  ##
  ## Set to false if bringing your own MySQL, and set the corresponding `secrets`
  ## fields that correspond to the PostgreSQL variables that `concourse web` should use
  ## to connect to.
  ##
  enabled: true

  fullnameOverride: cycloid-concourse

  imageTag: "6.7.8"

  ## Configuration values for the Concourse application (worker and web components).
  ## The values specified here are almost direct references to the flags under the
  ## `concourse web` and `concourse worker` commands.
  ##
  concourse:
    ## Configurations for the `web` component based on the possible flags configurable
    ## through the `concourse web` command.
    ##
    web:
      ## A name for this Concourse cluster, to be displayed on the dashboard page.
      ##
      clusterName: cycloid
      ## Enable equivalent resources across pipelines and teams to share a single version history.
      ## Ref: https://concourse-ci.org/global-resources.html
      ##
      enableGlobalResources: false
      ## Enable automatic rerunning of builds when worker disappears
      ##
      enableBuildRerunWhenWorkerDisappears: true
      ## URL used to reach any ATC from the outside world.
      ## This is *very* important for a proper authentication workflow as
      ## browser redirects are based on the value set here.
      ##
      ## Example: http://ci.concourse-ci.org
      ##
      externalUrl: http://concourse.cycloid.local

      # Disable the use of Kubernetes Secrets as the credential provider for concourse pipelines (true by default).
      kubernetes:
        enabled: false

      # Configuration for using Vault as a credential manager.
      ## Ref: https://concourse-ci.org/creds.html#vault
      ##
      vault:
        ## Enable the use of Vault as a credential manager.
        ##
        enabled: true

        ## URL pointing to vault addr (i.e. http://vault:8200).
        ##
        url: http://cycloid-vault:8200

        ## Vault path under which to namespace credentials lookup.
        ##
        pathPrefix: /cycloid

        ## Vault authentication backend, leave this blank if using an initial periodic token.
        ## Currently supported backends: token, approle, cert.
        ##
        authBackend: "approle"

        ## if the Vault authentication backend requires params from secrets, set this to true,
        ## and provide a value in secrets (field `vault-client-auth-param`).
        ##
        useAuthParam: true

      auth:
        mainTeam:
          ## Comma-separated list of local Concourse users to be included as members of the `main` team.
          ## Make sure you have local users support enabled (`concourse.web.localAuth.enabled`) and
          ## that the users were added (`secrets.localUsers`).
          ##
          localUser: "cycloid"

      ## Configurations regarding how the web component is able to connect to a postgres
      ## instance.
      ##
      postgres:
        ## The host to connect to. Need to be specified if bringing your own PostgreSQL.
        ##
        host:
        ## The port to connect to.
        ##
        port: 5432
        ## The name of the database to use.
        ##
        database: atc

    worker:
      baggageclaim:
        driver: overlay

  web:
    ## Enable or disable the web component.
    ## This allows the creation of worker-only releases by setting this to false.
    ##
    enabled: true
    ## Number of replicas.
    ##
    replicas: 1

    ## Array of extra containers to run alongside the Concourse Web
    ## container.
    ##
    ## Example:
    ## - name: myapp-container
    ##   image: busybox
    ##   command: ['sh', '-c', 'echo Hello && sleep 3600']
    ##
    sidecarContainers:
      - name: concourse-team-authorized-key-sync
        image: cycloid/concourse-team-authorized-key-sync:latest
        imagePullPolicy: Always
        env:
          - name: VAULT_URL
            value: http://cycloid-vault:8200
          - name: VAULT_ROLE_ID
            value: "##cycloid-ro-vault-approle-role-id##"
          - name: VAULT_SECRET_ID
            value: "##cycloid-ro-vault-approle-secret-id##"
          - name: YAML_KEYS_FILE
            value: /etc/concourse-teams/tsa-team-authorized-keys.yaml
          - name: VERBOSE
            value: "True"
        resources:
          requests:
            cpu: 100m
            memory: 64Mi
          limits:
            cpu: 100m
            memory: 128Mi
        volumeMounts:
          - mountPath: /etc/concourse-teams
            name: concourse-teams

    ## Array of extra initContainers to run alongside the Concourse Web
    ## container.
    ##
    ## Example:
    ## - name: myapp-init-container
    ##   image: busybox
    ##   command: ['sh', '-c', 'echo Hello && sleep 3600']
    ##
    extraInitContainers:
      - name: concourse-team-authorized-key-init
        image: busybox
        env:
        - name: YAML_KEYS_FILE
          value: /etc/concourse-teams/tsa-team-authorized-keys.yaml
        command:
          - /bin/sh
          - -c
          - |
            touch $YAML_KEYS_FILE;
        volumeMounts:
          - mountPath: /etc/concourse-teams
            name: concourse-teams

    ## Enable or disable the process namespace sharing for the web nodes.
    ## This allows signaling the concourse process from a sidecar container.
    ## eg.: signal concourse web to reload the team authorized keys file.
    ##
    ## Ref: https://kubernetes.io/docs/tasks/configure-pod-container/share-process-namespace/
    ##
    shareProcessNamespace: true

    ## Configure resource requests and limits.
    ## Ref: https://kubernetes.io/docs/user-guide/compute-resources/
    ##
    resources:
      requests:
        cpu: "100m"
        memory: "1Gi"
      limits:
        cpu: "1000m"
        memory: "1.5Gi"

    ## Configure additional environment variables for the
    ## web containers.
    ## Example:
    ##
    ##   - name: CONCOURSE_LOG_LEVEL
    ##     value: "debug"
    ##   - name: CONCOURSE_TSA_LOG_LEVEL
    ##     value: "debug"
    ##
    env:
      - name: CONCOURSE_TSA_TEAM_AUTHORIZED_KEYS_FILE
        value: /etc/concourse-teams/tsa-team-authorized-keys.yaml

    ## Configure additional volumes for the
    ## web container(s).
    ##
    ## Example:
    ##
    ##   - name: my-team-authorized-keys
    ##     configMap:
    ##       name: my-team-authorized-keys-config
    ##
    ## Ref: https://kubernetes.io/docs/concepts/storage/volumes/
    ##
    additionalVolumes:
      - name: concourse-teams
        emptyDir: {}

    ## Configure additional volumeMounts for the
    ## web container(s)
    ##
    ## Example:
    ##
    ##  - name: my-team-authorized-keys
    ##    mountPath: /my-team-authorized-keys
    ##
    ## Ref: https://kubernetes.io/docs/concepts/storage/volumes/
    ##
    additionalVolumeMounts:
      - name: concourse-teams
        mountPath: /etc/concourse-teams

    ## Ingress configuration.
    ## Ref: https://kubernetes.io/docs/user-guide/ingress/
    ##
    ingress:
      ## Enable Ingress.
      ##
      enabled: false

      ## Annotations to be added to the web ingress.
      ## Example:
      ##   kubernetes.io/ingress.class: nginx
      ##   kubernetes.io/tls-acme: 'true'
      ##
      annotations: {}

      ## Hostnames.
      ## Must be provided if Ingress is enabled.
      ## Example:
      ##   - concourse.domain.com
      ##
      hosts:
        - concourse.cycloid.local

      ## TLS configuration.
      ## Secrets must be manually created in the namespace.
      ## Example:
      ##   - secretName: concourse-web-tls
      ##     hosts:
      ##       - concourse.domain.com
      ##
      tls: []
        #  - secretName: cycloid-local-tls
        #    hosts:
        #      - concourse.cycloid.local

  ## Configuration values for Concourse Worker components.
  ## For more information regarding the characteristics of
  ## Concourse Workers, see https://concourse-ci.org/concourse-worker.html
  ##
  worker:

    ## Enable or disable the worker component.
    ## This can allow users to create web only releases by setting this to false
    ##
    enabled: false

    ## Number of replicas.
    ##
    replicas: 1

    ## Configure resource requests and limits.
    ## Ref: https://kubernetes.io/docs/user-guide/compute-resources/
    ##
    resources:
      requests:
        cpu: "1"
        memory: "512Mi"
      limits:
        memory: "1Gi"

    ## Node selector for the worker nodes.
    ## Ref: https://kubernetes.io/docs/concepts/configuration/assign-pod-node/#nodeselector
    ##
    nodeSelector: {}

  ## Persistent Volume Storage configuration.
  ## Ref: https://kubernetes.io/docs/user-guide/persistent-volumes
  ##
  persistence:
    ## Enable persistence using Persistent Volume Claims.
    ## Ignored for Kind: Deployment. If persistence is needed use kind: StatefulSet
    ##
    enabled: true

    ## Worker Persistence configuration.
    ##
    worker:
      ## concourse data Persistent Volume Storage Class
      ## If defined, storageClassName: <storageClass>
      ## If set to "-", storageClassName: "", which disables dynamic provisioning
      ## If undefined (the default) or set to null, no storageClassName spec is
      ##   set, choosing the default provisioner.  (gp2 on AWS, standard on
      ##   GKE, AWS & OpenStack)
      ##
      storageClass:

      ## Persistent Volume Access Mode.
      ##
      accessMode: ReadWriteOnce

      ## Persistent Volume Storage Size.
      ##
      size: 20Gi

  postgresql:
    ## Use the PostgreSQL chart dependency.
    ##
    ## Set to false if bringing your own PostgreSQL, and set the corresponding `secrets`
    ## fields that correspond to the PostgreSQL variables that `concourse web` should use
    ## to connect to.
    ##
    enabled: true

    fullnameOverride: cycloid-concourse-postgresql

    ### PostgreSQL User to create.
    ##
    postgresqlUsername: concourse
    ## PostgreSQL Password for the new user.
    ## If not set, a random 10 characters password will be used.
    ##
    postgresqlPassword: "ori9aigee0phivooX1jei1Ee"
    ## PostgreSQL Database to create.
    ##
    postgresqlDatabase: atc

    ## Persistent Volume Storage configuration for PostgreSQL.
    ##
    ## Ref: https://kubernetes.io/docs/user-guide/persistent-volumes
    ##
    persistence:
      ## Enable PostgreSQL persistence using Persistent Volume Claims.
      ##
      enabled: true
      ## Persistent Volume Storage Class to be used by PersistentVolumes created
      ## for PostgreSQL.
      ##
      ## If defined, storageClassName: <storageClass>
      ## If set to "-", storageClassName: "", which disables dynamic provisioning
      ## If undefined (the default) or set to null, no storageClassName spec is
      ##   set, choosing the default provisioner.  (gp2 on AWS, standard on
      ##   GKE, AWS & OpenStack)
      ##
      storageClass:
      ## Persistent Volume Access Mode.
      ##
      accessModes:
        - ReadWriteOnce
      ## Persistent Volume Storage Size.
      ##
      size: 8Gi

  secrets:
    ## Secrets for DB access if bringing your own PostgreSQL
    ##
    postgresUser:
    postgresPassword:

    ## List of `username:password` or `username:bcrypted_password` combinations for all your local concourse users.
    ## For details of expected format, see https://concourse-ci.org/local-auth.html
    ##
    localUsers: "cycloid:jeiVahChaipheigai8ohkuc0"

    ## Concourse Host Keys.
    ## Ref: https://concourse-ci.org/install.html#generating-keys
    ##
    hostKey: |-
      -----BEGIN RSA PRIVATE KEY-----
      MIIEogIBAAKCAQEA2AUPXxuiDC/qrBWjIdT5fvNcMlMEYpR3X4SLQIgLC1ULDsCO
      fleKZ+Wi4RzwbkUKiKmJm5GeyNVVCDdfvdD1Sd1+5faqmp2/OQBzLS7o8NY/btMw
      8h9lx4KVJaJJ1EM1EiyGY41Nx591KP14pBfr0/NdOIrDu2JvF6e7CHEbrzkN57kb
      BVQkaIMaS01Rw/5Oe68GFalli2ii8L8dNWVVzquBh5PwVWimvTgwv3TYG2TH8L1V
      V7n+/zRRpkjMl2+PUouGqD+Bp+4wF+hp4AW5v24CqjtLJEMv4IEJv2FRfrOauBIZ
      XjAS1SSg9VaTOS3iwxaYrv8uG1XfMFHICvkEPQIDAQABAoIBAG87W8jrX6vK2Jm3
      ooJ/OeFmymiXWsCwFi+2/kVCR/2T0tfLyxO/W+NX2WD1F9CP+HaaZeMXPp3HS7up
      V8FT4ZohVYBwXTS0WYyucKApcYThrVQRpzhldnEfClGQmVeVK7Sp/KEyV4Sc1SVA
      L2i/cI142N2Ohm7spquVkLcuFsVINzZ0fXCv25dTqbkEgjTJzNdBzyFXvc4z0Mt9
      gW14M7mz+YKYOfsCxIEm438fC9b16C96yIFBdN+/jaP8pmb2RoIE2D0F8bj5K1hR
      YyGFKMOU4e6cYq59iWfubKuu2WNJEBk/5aO7x7Xu2S0k8wIYlwxFuu4LfR2Kvizu
      +mFVf3kCgYEA9e0+40tJGpOPM8hAB3DwXjYc8lCuyYf3z30T3RqVNCUVSWnlaj/s
      3ENi6+Ng3u+Zs8cR2CFou+jAClTyWLuSnI9yACD0eyW9n4bzYMUbgdC6vneLjpzx
      wWR9Xv5RmZVly7xWuqcgEeEf8RNcYI3oXby0laF3EObvuAx/4ETIkFcCgYEA4N42
      w1UEWGopWBIIXYHkEPHQuF0SxR2CZyh9ExTeSxFphyibkcHRjDW+t91ZLnSm5k1N
      TOdYuc0ApBV3U+TexeFvDI94L/Oze6Ht5MatRQz8kRwMFGJL3TrpbgTmWdfG05Ad
      oiScJzwY16oJXnKusxik7V+gCCNNE0/2UuMnY4sCgYAEf82pvOPef5qcGOrK+A79
      ukG3UTCRcVJgUmp9nhHivVbxW+WdlwPPV9BEfol0KrAGMPsrmBjhbzWsOregVfYt
      tRYh2HiAlEUu2Po06AZDzrzL5UYBWu+1WRBOH5sAk1IkcxKnIY2dph++elszTQVW
      SbCIGEckYQU7ucbRJJECywKBgBb4vHFx8vKxTa3wkagzx7+vZFohL/SxEgxFx5k2
      bYsPqU8kZ9gZC7YeG3CfDShAxHgMd5QeoiLA/YrFop4QaG2gnP6UfXuwkqpTnYDc
      hwDh1b9hNR6z9/oOtaAGoh2VfHtKYqyYvtcHPaZyeWiLoKstHlQdi7SpHouVhJ1t
      FS4HAoGAGy+56+zvdROjJy9A2Mn/4BvWrsu4RSQILBJ6Hb4TpF46p2fn0rwqyhOj
      Occs+xkdEsI9w5phXzIEeOq2LqvWHDPxtdLpxOrrmx4AftAWdM8S1+OqTpzHihK1
      y1ZOrWfvON+XjWFFAEej/CpQZkNUkTzjTtSC0dnfAveZlasQHdI=
      -----END RSA PRIVATE KEY-----

    hostKeyPub: |-
      ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDYBQ9fG6IML+qsFaMh1Pl+81wyUwRilHdfhItAiAsLVQsOwI5+V4pn5aLhHPBuRQqIqYmbkZ7I1VUIN1+90PVJ3X7l9qqanb85AHMtLujw1j9u0zDyH2XHgpUloknUQzUSLIZjjU3Hn3Uo/XikF+vT8104isO7Ym8Xp7sIcRuvOQ3nuRsFVCRogxpLTVHD/k57rwYVqWWLaKLwvx01ZVXOq4GHk/BVaKa9ODC/dNgbZMfwvVVXuf7/NFGmSMyXb49Si4aoP4Gn7jAX6GngBbm/bgKqO0skQy/ggQm/YVF+s5q4EhleMBLVJKD1VpM5LeLDFpiu/y4bVd8wUcgK+QQ9 Concourse

    ## Concourse Session Signing Keys.
    ## Ref: https://concourse-ci.org/concourse-generate-key.html
    ##
    sessionSigningKey: |-
      -----BEGIN RSA PRIVATE KEY-----
      MIIEowIBAAKCAQEAwLql/rUIaI+PX7Tl3FWcTee4sQf8/daakALXx955tPwkhqlY
      e4T2V84p/ylFvNWpM4vfcMYKfMY0JLKgAgBvJhCytSkDBhTBoWmN6yE0AB11P9En
      lIZRBWNYqaC2cSge2ZD8qOSnwfFhnQAW8+7pE+ElJAVh7dtdF3A478H50lIigq8I
      zMWp2EGJpFC7/Uu36oIL/03MNGCmrH1jvtTuJiAMQUZYyL1ReBkvvHOzw9i4HXPy
      SMVtcllm4NBs2aVPtwhr2kwSkLt8t1bPdRn6OIyEAw5WktzAKaiZnkTvj6g3xzdp
      zKcrdlBr9aznlNvoSinBUfvtwyFmvFN1HHbA9wIDAQABAoIBAE7G/DrUfI9gvtX7
      90jMpYsigFe8UCjho2PiBZlo0o6r0bJJXiV+/8J8PqZRlHPPUc4EClzqVjcSPRYS
      /VxUGRqSELoD/Xxq14rGvn+xnrO9VsOzFl6bWFq/dOpBCtHN+G4t2VifvgKES8YE
      11z19sdta+UBXjn/RFnkQSGfRCI3QqTaYvjxevt0uWlyPmqkFPQQw8bvHIXzoB+B
      rzeiMa++nMvbX5pAH9XA0BvhyuH3fHidTUwiVBpkMcpLWtjP0A0JTsecDdbinDDq
      un2EIo8zMWRwKQN/JnUxsi8AUEigBTCUqeDgREXtW62uvFkSpcVMXwmVityLYIVy
      qnVLUCECgYEA6IwXkP1qnSfcNeoVI/ypDuz1/kdqcjSPhLYe+jdiLLoFkMW9AlDm
      lzwNaWlTFD9ygo+NjJCo63/A8HCm55sajws5hZ6r20vdZcKFMk9h0qF5oVA7lkQ2
      gvG2WaznuU7KkqhfP+pXhiLgZKoJkst/+g7r6uHpredwDY6hxeBK4vsCgYEA1CqH
      8ywC5qUo/36kQg/TU2adN/YEHdJAAbU23EVrGQSVmnXW08H2NLFk0tsxrwoNnbgp
      PIk2J7BimbJvbND17ibr4GAklDTsR8aJkDl+0JgNCAK9N07qVt1s7FXzhg95jUL9
      EQW55z60GAJpecqNwA4Jsa8P852N0355Obp92TUCgYBkOBvf7JcJ66fHxH4f6D+j
      oxPQ5k5Fsck4VJS9GSlCRVkor09ptBvsiYDuMOoRC9b51YwXTDDAbWplNOd5YSrt
      AtVjdKJz/BoKRO7KY9Owxs54au+DLxqfDDSeKRokjoRW+CE0lnXp5RX3zCAcF3+r
      8MpTi9D9lYSBEzs84BDmCQKBgQCMcH6/K3HcJJVn0fd+tyUGftUw9sswxjySJNbk
      pZrH263/qWMDls+Xf5kire9MU1ZCAWZiaN0NFoed/2wcVpGEDAV0548u/30r4bKr
      YjOcdhmiJNYFJ1qdF0MDib2CDvpB1IbZXrX46RujDO2urbJ435HxKNVhR/had8xc
      tyKYxQKBgCVDhN0MhnlUQJVZfX42APmF4gQg0r3sfL/NGXjEjMIKKFe5a88eZVHr
      L8x1+dp0q7czC8a/l1DUuiwDKl8OEpxLsGCq/J/wAfrSMPifu6EUlbUwlJOPdgha
      +p/KFAelHXJ2w/8yackAcarh35VP7ixhuvxswHNdgvfsBTFcjn30
      -----END RSA PRIVATE KEY-----

    ## Concourse Worker Keys.
    ## Ref: https://concourse-ci.org/concourse-generate-key.html
    ##
    workerKey: |-
      -----BEGIN RSA PRIVATE KEY-----
      MIIEpAIBAAKCAQEAuPehUmBXAQCoA7TLAQCYhf+vzcZVyj+VGXnMhLHnWLk7dRjo
      CU8GgNamdS5h7G3ywxOvKA3YjOLr8XyOMLS4c+e8N7tIzlMWdiXhe0lcBH9Z1ai5
      +Bof3/BlDUBksiKdc1A+QcfX6tDwMkOO5re1H4vOK3H/Cype58wCB03HYNgb05ED
      fW1Bj2qvz29VtmyjwEMuDs100iMqwCfPUx9oxXmmX8sUBRmw/Y1Rx/8pdKIjKw3m
      kWIHHBOSCPimO1qC47Aa8v/UH9hERCykyuFHiBiKlnIvZWm9bYvhsRTz4gt5KzRY
      6OI0oVeHlLOHDSK48Da8VWij15lOqO2Nx6WssQIDAQABAoIBADET22UNFOi6MNpS
      5S5N5ypezlnOD0NLnZcV3zMyNQ0wkNsgEakuo64Zxi7/cJIYFjq2hVoeWl//cdUw
      VFYODYcLbMBo3AeKukH9CRf6PgUfeUmcrENtQxnbIiTi+hTd5GMNXod7rAmtCJ59
      mHQVOGS3ZqvWYnKm+mmMktk3RPinynX/A4y3WHPacuAS58HM09Ck43WcHMxbGpsL
      /gZpICyFYZ2DviM+AHyWGcmw7LJrpC0QHo6+BAFMs4xlUecNgVIFUpfOoAcfsdtG
      K9j4AbuZ47iFisbay+1pyg/7O5eRTdGVQRtc7PBMOjea5jGsfmlDmdn1ZS50ykun
      ANfoQ5UCgYEA9Ak73PRy9nLlRkt4OBCF/4fwThUCMedsnWaVjQBMJYim4FB2ivF5
      cKdWt3y/RZI85KKYu0EXhLEoSIEAfz057R8t3QdVK4tZx6B47UFjBjCYeVMtwHDQ
      prxQiOPHIHCplBNFuGzA5VXL9gQLRD+ek0uOy2GJJ0Wu1xyeouI+SW8CgYEAwgkO
      TOtOogqmcAALjWgeeQiZetflSKbJlpQNhmCPAMm0SFI8eF4SpRXLzd41VC2mLIwT
      L3tjc7/8ocXoElFM4L0fo9Lx/SHFH4JEn5FT0PXPmvsF2JRhsXJFLJSihxF/91Xs
      2aBcQILPFzLcrI6OFUakNwGTU/CIxpkzRvQrG98CgYEAzNVnUuo4CNadzagRK3Xr
      E3Yl5VRK+FpY17FAfA6w25xc/dFr/un61e0Po4no/ltmEz7LVfmn5O/ScTEemq5o
      jbjrBShfe+JGpIH0nqiQlqR5hvSjZXEMIbfVHWGbRYZrQGgA0HEwZA7k2QXB8zI3
      R0lXfSzMM5OQ0uwp12xxfa8CgYBHILq1R6zTicPpWprhg0FobNaWSX4rW7iaEjvC
      /rJtP4Nu33Z7SUDcc1j6ZnJ2ISXBPrfpt/mE/OPHCZ1A2bysxadLjpBWkoKIQmCV
      fdiTyQgJb+t8sSf+vDzPUs0hZjDaogzo2ff3TfxMLMDoIHnFItgfsdwn8QyygIZj
      hC4pUQKBgQDqsxnkI6yXFE5gshnW7H8zqKNlzKd/dZEL6e+lRz4R3UY/KcEkRAfq
      Yi3cwo9fE3U3kSmpl5MQwUjWm/BZ7JyueoY/4ndwaFPgc34IKsgJ0wau9pZiQAB1
      DxpOSF+BR71Jx3sxvIdCODNTtm645j5yrZVnJAuMPofo5XFmunDoJA==
      -----END RSA PRIVATE KEY-----

    workerKeyPub: |-
      ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQC496FSYFcBAKgDtMsBAJiF/6/NxlXKP5UZecyEsedYuTt1GOgJTwaA1qZ1LmHsbfLDE68oDdiM4uvxfI4wtLhz57w3u0jOUxZ2JeF7SVwEf1nVqLn4Gh/f8GUNQGSyIp1zUD5Bx9fq0PAyQ47mt7Ufi84rcf8LKl7nzAIHTcdg2BvTkQN9bUGPaq/Pb1W2bKPAQy4OzXTSIyrAJ89TH2jFeaZfyxQFGbD9jVHH/yl0oiMrDeaRYgccE5II+KY7WoLjsBry/9Qf2ERELKTK4UeIGIqWci9lab1ti+GxFPPiC3krNFjo4jShV4eUs4cNIrjwNrxVaKPXmU6o7Y3Hpayx Concourse

    ## vault authentication parameters
    ## Parameter to pass when logging in via the backend
    ## Required for "approle" authenication method
    ## e.g. "role_id:x,secret_id:x"
    ## Ref: https://concourse-ci.org/vault-credential-manager.html#vault-approle-auth
    ##
    vaultAuthParam: "role_id:##cycloid-ro-vault-approle-role-id##,secret_id:##cycloid-ro-vault-approle-secret-id##"

#
# Vault
#
# Configuration values for the vault dependency.
# Ref: https://github.com/hashicorp/vault-helm
#
vault:
  # Use the Vault chart dependency.
  #
  # Set to false if bringing your own MySQL, and set the corresponding `secrets`
  # fields that correspond to the PostgreSQL variables that `concourse web` should use
  # to connect to.
  #
  enabled: true

  injector:
    enabled: false

    leaderElector:
      enabled: false

  server:
    image:
      tag: "1.5.4"


    # This configures the Vault Statefulset to create a PVC for data
    # storage when using the file or raft backend storage engines.
    # See https://www.vaultproject.io/docs/configuration/storage/index.html to know more
    dataStorage:
      enabled: true
      # Size of the PVC created
      size: 10Gi
      # Location where the PVC will be mounted.
      mountPath: "/vault/data"
      # Name of the storage class to use.  If null it will use the
      # configured default Storage Class.
      storageClass: null
      # Access Mode of the storage device being used for the PVC
      accessMode: ReadWriteOnce
      # Annotations to apply to the PVC
      annotations: {}

    # Run Vault in "standalone" mode. This is the default mode that will deploy if
    # no arguments are given to helm. This requires a PVC for data storage to use
    # the "file" backend.  This mode is not highly available and should not be scaled
    # past a single replica.
    standalone:
      # config is a raw string of default configuration when using a Stateful
      # deployment. Default is to use a PersistentVolumeClaim mounted at /vault/data
      # and store data there. This is only used when using a Replica count of 1, and
      # using a stateful set. This should be HCL.

      # Note: Configuration files are stored in ConfigMaps so sensitive data
      # such as passwords should be either mounted through extraSecretEnvironmentVars
      # or through a Kube secret.  For more information see:
      # https://www.vaultproject.io/docs/platform/k8s/helm/run#protecting-sensitive-vault-configurations
      config: |
        ui = true
        listener "tcp" {
          tls_disable = 1
          address = "[::]:8200"
          cluster_address = "[::]:8201"
        }
        storage "file" {
          path = "/vault/data"
        }

    resources: {}
    # resources:
    #   requests:
    #     memory: 256Mi
    #     cpu: 250m
    #   limits:
    #     memory: 256Mi
    #     cpu: 250m

    # Ingress allows ingress services to be created to allow external access
    # from Kubernetes to access Vault pods.
    # If deployment is on OpenShift, the following block is ignored.
    # In order to expose the service, use the route section below
    ingress:
      enabled: false
      labels: {}
        # traffic: external
      annotations: {}
        # |
        # kubernetes.io/ingress.class: nginx
        # kubernetes.io/tls-acme: "true"
        #   or
        # kubernetes.io/ingress.class: nginx
        # kubernetes.io/tls-acme: "true"

      # When HA mode is enabled and K8s service registration is being used,
      # configure the ingress to point to the Vault active service.
      activeService: true
      hosts:
        - host: vault.cycloid.local
          paths: []
      tls: []
      #  - secretName: cycloid-local-tls
      #    hosts:
      #      - vault.cycloid.local
