server {
    listen       443 ssl;
    server_name  "{{ cycloid_console_dns }}";

    #access_log /var/log/nginx/cycloid-console-access.log;
    #error_log  /var/log/nginx/cycloid-console-error.log;

    ssl_certificate /etc/nginx/ssl/ssl.crt;
    ssl_certificate_key /etc/nginx/ssl/ssl.key;

    location / {
      proxy_pass http://cycloid-frontend;
#      proxy_pass http://cycloid-frontend:3000;
      proxy_set_header   X-FORWARDED_PROTO https;
      proxy_set_header   X-FORWARDED_PORT 443;
    }
    location /api {
      proxy_set_header   X-FORWARDED_PROTO https;
      proxy_set_header   X-FORWARDED_PORT 443;
      proxy_set_header   Host {{ cycloid_api_dns }};
      proxy_buffering  off;
      proxy_cache      off;
      proxy_connect_timeout 3600;
      proxy_send_timeout    3600;
      proxy_read_timeout    3600;
      keepalive_timeout     3600;
      proxy_set_header Connection keep-alive;
      proxy_pass https://127.0.0.1/;
    }
}
